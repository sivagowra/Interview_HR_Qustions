<!DOCTYPE html>
<html lang="en">
<head>
    <title>AWS EC2 Volume Partition & Mount Guide</title>
    <meta charset="UTF-8">

    <style>
        body {
            font-family: "Segoe UI", Arial, sans-serif;
            line-height: 1.7;
            padding: 30px;
            background: #fafafa;
            color: #222;
            margin: 0;
        }

        h1, h2, h3 {
            font-weight: 600;
            margin-top: 30px;
            color: #0a3d62;
        }

        h1 {
            font-size: 32px;
        }

        pre {
            background: #f0f0f0;
            padding: 16px;
            border-left: 5px solid #0a3d62;
            border-radius: 6px;
            font-size: 15px;
            overflow-x: auto;
            white-space: pre-wrap;
        }

        code {
            background: #f0f0f0;
            padding: 3px 6px;
            border-radius: 4px;
        }

        ul {
            background: #f0f0f0;
            padding: 12px 18px;
            border-radius: 6px;
            border-left: 5px solid #0a3d62;
            list-style: square;
        }

        p {
            font-size: 16px;
        }

        div {
            background: #ffffff;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #ddd;
            margin-top: 25px;
        }

        .note {
            background: #e8f4ff;
            border-left: 6px solid #0d6efd;
            padding: 15px;
            border-radius: 6px;
            margin-top: 20px;
        }

        .success {
            background: #e6fffa;
            border-left: 6px solid #198754;
            padding: 15px;
            border-radius: 6px;
            margin-top: 20px;
        }
    </style>
</head>

<body>

<h1>EC2 Ubuntu — Volume Partition, Format & Mount Guide</h1>

<h2>1. Create Partition on /dev/xvdf</h2>
<pre>
sudo fdisk /dev/xvdf
n
p
1
&lt;enter&gt;
&lt;enter&gt;
w
</pre>

<h2>2. Format & Mount /dev/xvdf1</h2>
<pre>
sudo mkfs.ext4 /dev/xvdf1
sudo mkdir /mnt/vol1
sudo mount /dev/xvdf1 /mnt/vol1
</pre>

<h2>3. Check Mounted Volumes</h2>
<pre>df -h</pre>

<div>
<h3>PART 1 — How to UNMOUNT & DETACH VOLUME</h3>

<pre>sudo umount /mnt/vol1</pre>
<pre>df -h</pre>

<p>AWS Console → EC2 → Volumes → Detach Volume</p>
</div>

<h2>Attach Volume to New Instance</h2>
<ul>
    <li>Attach volume as <code>/dev/sdf</code></li>
    <li>Linux detects as <code>/dev/xvdf</code></li>
</ul>

<pre>lsblk</pre>

<pre>
xvdf
└─xvdf1
</pre>

<h2>Mount Existing Partition</h2>
<pre>
sudo mkdir -p /mnt/vol1
sudo mount /dev/xvdf1 /mnt/vol1
</pre>

<h2>Verify Data</h2>
<pre>ls /mnt/vol1</pre>

<h2>Make EBS Volume Permanent</h2>

<h2>OR</h2>
<h2>Auto Mount /dev/xvdp1 & /dev/xvdp2 on Reboot</h2>

<pre>sudo blkid</pre>

<pre>
/dev/xvdp1 UUID="UUID-1"
/dev/xvdp2 UUID="UUID-2"
</pre>

<pre>
sudo nano /etc/fstab
</pre>

<pre>
UUID=UUID-1 /mnt/vol2 ext4 defaults,nofail 0 0
UUID=UUID-2 /mnt/vol3 ext4 defaults,nofail 0 0
</pre>

<div class="note">
<strong>XFS Filesystem:</strong>
<pre>
UUID=UUID-1 /mnt/vol2 xfs defaults,nofail 0 0
UUID=UUID-2 /mnt/vol3 xfs defaults,nofail 0 0
</pre>
</div>

<pre>
sudo mount -a
sudo reboot
</pre>

<div class="success">
<strong>After reboot:</strong>
<pre>df -h</pre>
</div>

<h2>Create New EBS Volume with 2 Partitions</h2>

<pre>
sudo fdisk /dev/xvdp
n
p
1
+1G
n
p
2
w
</pre>

<pre>
sudo mkfs.ext4 /dev/xvdp1
sudo mkfs.ext4 /dev/xvdp2
</pre>

<pre>
sudo mkdir -p /mnt/vol2 /mnt/vol3
sudo mount /dev/xvdp1 /mnt/vol2
sudo mount /dev/xvdp2 /mnt/vol3
</pre>

<pre>df -h</pre>

<h2>Unmount Error Fix (target is busy)</h2>

<pre>
sudo lsof +f -- /mnt/vol1
sudo fuser -m /mnt/vol1
sudo fuser -k /mnt/vol1
sudo umount /mnt/vol1
</pre>

<h3>Lazy Unmount</h3>
<pre>sudo umount -l /mnt/vol1</pre>

<h3>Force Unmount (Last Option)</h3>
<pre>sudo umount -f /mnt/vol1</pre>

</body>
</html>
